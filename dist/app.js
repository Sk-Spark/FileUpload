(()=>{var e={108:(e,t,r)=>{var n=r(464),o=r(84);function i(){return(new Date).getTime()}var s,l=Array.prototype.slice,a={};s="undefined"!=typeof global&&global.console?global.console:"undefined"!=typeof window&&window.console?window.console:{};for(var u=[[function(){},"log"],[function(){s.log.apply(s,arguments)},"info"],[function(){s.log.apply(s,arguments)},"warn"],[function(){s.warn.apply(s,arguments)},"error"],[function(e){a[e]=i()},"time"],[function(e){var t=a[e];if(!t)throw new Error("No such label: "+e);delete a[e];var r=i()-t;s.log(e+": "+r+"ms")},"timeEnd"],[function(){var e=new Error;e.name="Trace",e.message=n.format.apply(null,arguments),s.error(e.stack)},"trace"],[function(e){s.log(n.inspect(e)+"\n")},"dir"],[function(e){if(!e){var t=l.call(arguments,1);o.ok(!1,n.format.apply(null,t))}},"assert"]],c=0;c<u.length;c++){var f=u[c],p=f[0],d=f[1];s[d]||(s[d]=p)}e.exports=s},155:e=>{var t,r,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var l,a=[],u=!1,c=-1;function f(){u&&l&&(u=!1,l.length?a=l.concat(a):c=-1,a.length&&p())}function p(){if(!u){var e=s(f);u=!0;for(var t=a.length;t;){for(l=a,a=[];++c<t;)l&&l[c].run();c=-1,t=a.length}l=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.push(new d(e,t)),1!==a.length||u||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},84:e=>{"use strict";e.exports=require("assert")},986:e=>{"use strict";e.exports=require("body-parser")},582:e=>{"use strict";e.exports=require("cors")},860:e=>{"use strict";e.exports=require("express")},674:e=>{"use strict";e.exports=require("express-fileupload")},517:e=>{"use strict";e.exports=require("lodash")},470:e=>{"use strict";e.exports=require("morgan")},121:e=>{"use strict";e.exports=require("qrcode")},464:e=>{"use strict";e.exports=require("util")},147:e=>{"use strict";e.exports=require("fs")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(()=>{var e=r(108),t=r(155);const n=r(860),o=r(674),i=r(582),s=r(986),l=r(470),a=r(517),u=r(17),c=r(147),{networkInterfaces:f}=r(37),p=r(121),d=f(),m=[];for(const t of Object.keys(d)){for(const e of d[t]){const t="string"==typeof e.family?"IPv4":4;e.family!==t||e.internal||m.push(e.address)}e.log("IPs:",m)}let g=0;m.forEach((t=>{((t,r)=>{const n=u.join(__dirname,"img",`${r}.jpg`);p.toFile(n,t,(t=>{e.error(t)})),e.log("QR URL:",t)})(`http://${t}:8383`,g++)}));const h=async()=>{let t=[];try{t=c.readdirSync("./uploads")}catch(t){e.log(t)}return e.log("upFiles:",t),t},y=n();y.use(o({createParentPath:!0})),y.use(i()),y.use(s.json()),y.use(s.urlencoded({extended:!0})),y.use(l("dev"));const v=t.env.PORT||8383;y.listen(v,(()=>e.log(`App is listening on port ${v}.`))),y.get("/",((e,t)=>{t.sendFile(u.join(__dirname,"/html/index.html"))})),y.get("/main.css",((e,t)=>{t.sendFile(u.join(__dirname,"/css/main.css"))})),y.get("/main.js",((e,t)=>{t.sendFile(u.join(__dirname,"/js/main.js"))})),y.get("/ip",((e,t)=>{t.send(m)})),y.get("/qrcode",((t,r)=>{let n=t.query.i;e.log("/qrcode",n),r.sendFile(u.join(__dirname,`/img/${n}.jpg`))})),y.get("/upload",(function(e,t){t.sendFile(u.join(__dirname,"/html/upload.html"))})),y.post("/upload",(async(t,r)=>{e.log("req",t);try{if(t.files){let n=[];if(e.log("req in else:"),Array.isArray(t.files.myfile))a.forEach(t.files.myfile,(e=>{e.mv("./uploads/"+e.name),n.push({name:e.name,mimetype:e.mimetype,size:e.size})}));else{let e=t.files.myfile;e.mv("./uploads/"+e.name),n.push({name:e.name,mimetype:e.mimetype,size:e.size})}r.send({status:!0,message:"Files are uploaded",data:n})}else r.send({status:!1,message:"No file uploaded"})}catch(t){e.log(t),r.status(500).send(t)}})),y.get("/download",(async(t,r)=>{const n=await h(),o=(e=>{let t="<ul>";return e.forEach((e=>{t+=`<li> <a href='getFile?file=${e}' > ${e} </a></li></br>\n`})),t+="</ul>",t})(n);e.log("Files: ",n),r.send("Files: "+o)})),y.get("/getFile",((t,r)=>{e.log(t.query);let n=t.query.file;e.log("fileName:",n),r.download(`./uploads/${n}`)})),y.get("/delete",(async(t,r)=>{if(t.query.file){let r=t.query.file;e.log("Delete file: ",r);try{c.unlinkSync("./uploads/"+r)}catch(t){e.log("Error:",t)}}const n=await h(),o=(e=>{let t="<ul>";return e.forEach((e=>{t+=`<li> ${e} <a href='delete?file=${e}' > [ X ] </a></li></br>\n`})),t+="</ul>",t})(n);e.log("Files: ",n),r.send("Files: "+o)}))})()})();